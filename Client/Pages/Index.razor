@page "/"
@using Functions.Shared.DTOs
@using Functions.Shared.Interfaces

<PageTitle>Events</PageTitle>

<h1>Events</h1>

<div class="row">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                Create New Event
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label for="eventName" class="form-label">Event Name</label>
                    <input type="text" class="form-control" id="eventName" @bind="newEventName" />
                </div>
                <div class="mb-3">
                    <label for="eventLocation" class="form-label">Location</label>
                    <input type="text" class="form-control" id="eventLocation" @bind="newEventLocation" />
                </div>
                <div class="mb-3">
                    <label for="eventDescription" class="form-label">Description</label>
                    <textarea class="form-control" id="eventDescription" @bind="newEventDescription"></textarea>
                </div>
                <div class="mb-3">
                    <label for="eventStartDate" class="form-label">Start Date/Time</label>
                    <input type="datetime-local" class="form-control" id="eventStartDate" @bind="newEventStartDateTime" />
                </div>
                <div class="mb-3">
                    <label for="eventEndDate" class="form-label">End Date/Time</label>
                    <input type="datetime-local" class="form-control" id="eventEndDate" @bind="newEventEndDateTime" />
                </div>
                <div class="mb-3">
                    <label for="eventPicture" class="form-label">Event Picture</label
                    <Microsoft.AspNetCore.Components.Forms.InputFile OnChange="HandleFileSelection" class="form-control" id="eventPicture" accept="image/*" />
                    @if (!string.IsNullOrEmpty(uploadStatusMessage))
                    {
                        <div class="mt-2 @(uploadStatusMessage.Contains("Error") ? "text-danger" : "text-success")">
                            @uploadStatusMessage
                        </div>
                    }
                    @if (!string.IsNullOrEmpty(profilePictureBase64))
                    {
                        <div class="mt-2">
                            <img src="data:@profilePictureContentType;base64,@profilePictureBase64" style="max-width: 200px; max-height: 200px;" />
                        </div>
                    }
                </div>
                <button class="btn btn-primary" @onclick="Submit">Create Event</button>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                Events List
            </div>
            <div class="card-body">
                @if (events.Count == 0)
                {
                    <p>No events available.</p>
                }
                else
                {
                    <div class="row">
                        @foreach (var evt in events)
                        {
                            <div class="col-md-6 mb-3">
                                <div class="card">
                                    @if (!string.IsNullOrEmpty(evt.ProfilePictureBase64))
                                    {
                                        <img src="data:image/png;base64,@evt.ProfilePictureBase64" class="card-img-top" alt="@evt.Name" />
                                    }
                                    <div class="card-body">
                                        <h5 class="card-title">@evt.Name</h5>
                                        <p class="card-text">@evt.Location</p>
                                        <p class="card-text">@evt.StartDateTime.ToString("g") - @evt.EndDateTime.ToString("g")</p>
                                        @if (!string.IsNullOrEmpty(evt.Description))
                                        {
                                            <p class="card-text">@evt.Description</p>
                                        }
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                }
            </div>
        </div>
    </div>
</div>